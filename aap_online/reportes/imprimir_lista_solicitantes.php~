<?php
    include("fpdf17/conectar.php");
    include("fpdf17/funciones_factura.php");
    require ("../funciones.php"); // llamado de funciones de la pagina

    //EMPRESA    
    $empresa="Alcadia Municipio Guanare";
    $siglas="ABMG";
    $rif="***********";
    $direccion="Guanare - Portuguesa";
    
    //Consulta
    $query = "SELECT * FROM solicitantes,tipo_solicitantes WHERE solicitantes.cod_tipo_solicitante=tipo_solicitantes.cod_tipo_solicitante order by cedula_rif";
    $result_detalle = pg_query($query);
    $total_registros=  pg_num_rows($result_detalle);

    $pdf=new PDF('L','mm','Letter');
    $pdf->AliasNbPages();
    $pdf->Open();
    $pdf->AddPage();
        
    $pdf->SetFont('Arial','B',16);
    $pdf->Image('./logo/logo.jpg',10,10,'20','','jpg','http://www.vpa.unellez.edu.ve');
    $pdf->SetLeftMargin(45);
    //$pdf->SetFillColor(200,220,255); //AZUL
    $pdf->SetFillColor(200,200,200);//GRIS
    $pdf->SetTextColor(0);
    $pdf->SetDrawColor(0,0,0);
    $pdf->SetLineWidth(.1);

    $pdf->MultiCell(0,6,utf8_decode($empresa),0,'C',0);//
    $pdf->Ln(0);
    $pdf->SetFontSize(12);
    //$pdf->Cell(16,6,utf8_decode('Dirección:').trim(utf8_decode($direccion)),0,0,'C',0);//
    $pdf->SetFont('');

    $pdf->MultiCell(0,6,utf8_decode('Dirección:').trim(utf8_decode($direccion)),0,'C',0);
    $html = '<b> RIF: </b>'.$rif.' <b>  Tlf: </b>'.$telefono.'  <b>Fax: </b>'.$fax.'  <b>Email:</b> <a href="mailto:'.$email.'" target="_blank">'.$email.'</a>';
    $pdf->WriteHTML(utf8_decode($html));
    $pdf->Line(65,27,265,27);
    
    $pdf->SetFont('Arial','B',12);
    $pdf->SetLeftMargin(65);
    $pdf->SetY(28);
    $pdf->Cell(0,6,utf8_decode('LISTADO DE SOLICITANTES REGISTRADOS'),0,0,'C',0);//
    $pdf->SetY(35);
    $pdf->SetX(10);
    $pdf->SetLeftMargin(10);
    $pdf->Line(10,35,265,35);
    
    //DATOS DEL CLIENTE
    $pdf->SetFont('','B');
    $pdf->SetFontSize(9);
    $pdf->SetFillColor(200,200,200);//GRIS

    //MOSTRAR DATOS
    $pdf->Ln(5);
    
    ///////////// FORMATO Y CABEZERA DE LA LISTA DE PERSONAL ///////////////////////////
    $pdf->SetFont('Times','B',11);
    $pdf->SetLeftMargin(10);

    $pdf->SetFillColor(200,220,255);	
    $pdf->SetFont('Times','B',9);	
    $pdf->SetWidths(array(17,35,40,10,20,45,45,45));	//336 total ancho PAGINA HORIZONTAL
    $pdf->SetAligns(array('C','C','C','C','C','C','C','C'));    
    
    $fill = true;
    $pdf->fill("$fill");
    $pdf->Row(array(utf8_decode("CI/RIF"),utf8_decode("Solicitante"),utf8_decode("Tipo"),utf8_decode("Sexo"),utf8_decode("Fec. Nac."),utf8_decode("Dirección"),utf8_decode("Teléfonos"),utf8_decode("email")));
    $fill = false;
    $pdf->fill("$fill");
    $fila=1;
////////////////////////////////////////////////////////////////////////////////////
    while ($row = pg_fetch_array($result_detalle)){
        $pdf->SetFillColor(230,235,255);
        $pdf->SetFont('Times','',8);	
        $pdf->SetWidths(array(17,35,40,10,20,45,45,45));	//257 total ancho PAGINA HORIZONTAL	
        $pdf->SetAligns(array('C','L','L','C','L','L','L','L'));
        $pdf->fill("$fill");

	if ($row[sexo_solicitante]==1) {
	    $sexo='M' 
	} else { $sexo='F' };
        
        $pdf->Row(array(utf8_decode($row['cedula_rif']),utf8_decode($row['nombre_solicitante']),utf8_decode($row['descripcion_tipo_solicitante']),$sexo,implode('/',array_reverse(explode('-',$resultados[fecha_nac]))),utf8_decode($row['direccion_habitacion']),utf8_decode($row['telefono_fijo']).'--'.utf8_decode($row['telefono_movil']),utf8_decode($row['email'])));

	$fila++;
	if ($fila==25){
		    $pdf->AliasNbPages();
    $pdf->Open();
    $pdf->AddPage();
		$pdf->SetFont('Arial','B',16);
		$pdf->Image('./logo/logo.jpg',10,10,'20','','jpg','http://www.vpa.unellez.edu.ve');
		$pdf->SetLeftMargin(45);
    
    		$pdf->SetFillColor(200,200,200);//GRIS
    		$pdf->SetTextColor(0);
    		$pdf->SetDrawColor(0,0,0);
    		$pdf->SetLineWidth(.1);

    		$pdf->MultiCell(0,6,utf8_decode($empresa),0,'C',0);//
    		$pdf->Ln(0);
    		$pdf->SetFontSize(12);
    		$pdf->SetFont('');

    		$pdf->MultiCell(0,6,utf8_decode('Dirección:').trim(utf8_decode($direccion)),0,'C',0);
		$html = '<b> RIF: </b>'.$rif.' <b>  Tlf: </b>'.$telefono.'  <b>Fax: </b>'.$fax.'  <b>Email:</b> <a href="mailto:'.$email.'" target="_blank">'.$email.'</a>';
    		$pdf->WriteHTML(utf8_decode($html));
    		$pdf->Line(65,27,206,27);
    
    		$pdf->SetFont('Arial','B',12);
    		$pdf->SetLeftMargin(65);
    		$pdf->SetY(28);
    		$pdf->Cell(0,6,utf8_decode('LISTADO DE SOLICITANTES REGISTRADOS'),0,0,'C',0);//
    		$pdf->SetY(35);
    		$pdf->SetX(10);
    		$pdf->SetLeftMargin(10);
    		$pdf->Line(10,35,275,35);
    
    		//DATOS DEL CLIENTE
    		$pdf->SetFont('','B');
    		$pdf->SetFontSize(9);
    		$pdf->SetFillColor(200,200,200);//GRIS

    		//MOSTRAR DATOS
    		$pdf->Ln(5);
    
    		///////////// FORMATO Y CABEZERA DE LA LISTA DE PERSONAL ///////////////////////////
    		$pdf->SetFont('Times','B',11);
    		$pdf->SetLeftMargin(10);

    		$pdf->SetFillColor(200,220,255);	
    		$pdf->SetFont('Times','B',9);	
		$pdf->SetWidths(array(17,35,40,10,20,45,45,45));//257 total ancho PAGINA HORIZONTAL	
	        $pdf->SetAligns(array('C','C','C','C','C','C','C','C'));    
    
    		$fill = true;
    		$pdf->fill("$fill");
    		$pdf->Row(array(utf8_decode("CI/RIF"),utf8_decode("Solicitante"),utf8_decode("Tipo"),utf8_decode("Sexo"),utf8_decode("Fec. Nac."),utf8_decode("Dirección"),utf8_decode("Teléfonos"),utf8_decode("email")));
    		$fill = false;
    		$pdf->fill("$fill");
    		$fila=1;
	}
    }  
    
    $pdf->Cell(0,6,utf8_decode('TOTAL REGISTROS IMPRESOS: '.$total_registros),0,0,'',0);//


//ahora mostramos el final de la factura
    $pdf->Ln(10);
    
    pg_close();
    $pdf->Output("catalogo_solicitantes.pdf","I");
?>
